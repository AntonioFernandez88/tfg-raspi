<!-- views/pages/index.ejs -->

<!DOCTYPE html>
<html lang="en">

<% include ../views/template/head %>
</head>
<body>

<nav class="navbar navbar-inverse">
     <% include ../views/template/nav %>
</nav>
<div id="content">
    <h1>Raspberry Pi vinculadas</h1>
    <script type="text/javascript">
        var valorCookie = Cookies.getJSON('pi');
        if(valorCookie != undefined){
            var longitudCookie = Object.keys(valorCookie).length;
        }
        if(longitudCookie > 0){
            html =  '<table class="pi-item">';
            html +=     '<thead><tr>';
            html +=           '<th>Mac</th>';
            html +=           '<th>NÂº serie</th>';
            html +=           '<th>Id</th>';
            html +=           '<th>Opciones</th>';
            html +=     '</tr></thead>';
            html +=     '<tbody>';

            $.each(valorCookie,function(i,id){
                html +=     '<tr>'
                html +=             '<td>';
                html +=                 valorCookie[i].mac;
                html +=             '</td>';
                html +=             '<td>';
                html +=                 valorCookie[i].nserial;
                html +=             '</td>';
                html +=             '<td>';
                html +=                 valorCookie[i].id;
                html +=             '</td>';
                html +=             '<td>';
                html +=                 '<a type="button" href="/actions?id='+id.id+'" class="btn btn-primary btn-sm btn-round"><span class="glyphicon glyphicon-eye-open"></span></a>';
                html +=                 '<button type="button" onclick="showConfirm(function(){deleteCookie(\'' + id.id +'\')});" class="btn btn-danger btn-sm btn-round"><span class="glyphicon glyphicon-trash"></span></button>';
                html +=             '</td>';
                html +=     '</tr>';
            });
            html +=     '</tbody>';
            html += '</table>';
        }else{
            html = '<tr><td>No hay Raspberry Pi Vinculadas</td></tr>';
        }

        document.write(html);

        function deleteCookie(id){
            delete valorCookie[id];
            Cookies.set('pi', valorCookie);
            document.location.reload();
        }

        //$('#pi').html(html);
    </script>
    <div id="pi"></div>
</div>
<% include ../views/template/footer %>

