<!-- views/pages/index.ejs -->

<!DOCTYPE html>
<html lang="en">

<% include ../views/template/head %>
</head>
<body>

<nav class="navbar navbar-inverse">
     <% include ../views/template/nav %>
</nav>
<div id="content">
    <h1>Raspberry Pi vinculadas</h1>
    <div class="item">
        <script type="text/javascript">
            var valorCookie = Cookies.getJSON('pi');
            var html;
            if(valorCookie != undefined){
                var longitudCookie = Object.keys(valorCookie).length;
            }
            if(longitudCookie > 0){
                $.each(valorCookie,function(i,id){
                        html = '<div class="item-title"></div>';
                        html += '<div class="item-content">';
                            html += '<div class="item-attribute">';
                               html += ' <b>Mac:</b> '+valorCookie[i].mac+'';
                            html += '</div>';
                            html += '<div class="item-attribute">';
                                html += '<b>NÂº Serie:</b> '+valorCookie[i].nserial+'';
                            html += '</div>';
                        html += '</div>';
                        html += '<div class="item-options">';
                            html += '<ul>';
                                html += '<li>';
                                    html += '<a type="button" href="/actions?id='+id.id+'" class="btn btn-primary btn-sm btn-round">';
                                        html += '<span class="glyphicon glyphicon-eye-open"></span> Ver';
                                    html += '</a>';
                                html += '</li>';
                                html += '<li>';
                                    html += '<button type="button" onclick="showConfirm(function(){deleteCookie(\'' + id.id +'\')});" class="btn btn-danger btn-sm btn-round">';
                                        html += '<span class="glyphicon glyphicon-trash"></span> Eliminar';
                                    html += '</button>';
                            html +=    '</li>';
                            html += '</ul>';
                        html += '</div>';
                        html += '</div>';
                        document.write(html);
                });
            }else{
                html = 'No hay Raspberry Pi Vinculadas';
                html += '</div>';
                document.write(html);
            }

            function deleteCookie(id){
                delete valorCookie[id];
                Cookies.set('pi', valorCookie);
                document.location.reload();
            }
        </script>

        <% if (link != '') { %>
            <div class="alert alert-success" role="alert"><%= link %></div>
        <% } %>
</div>
<% include ../views/template/footer %>

